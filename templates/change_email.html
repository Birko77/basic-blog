{% extends "base.html" %}

{% block page_title %}
    Change email address
{% endblock page_title %}

{% block back_link %}
    <a class="custom_link_navbar" href="/user_settings"><span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span></a>
{% endblock back_link %}



{% block content %}
    <br>
    <div class="row">
        <div class="col-xs-12 text-center">
            <div class="text-box">
                <h1><strong>Change email address</strong></h1>
                <h3>Current email address: {{user.email}}</h>
            </div>
        </div>
    </div>
    <br>
    <div class="row">
        <div class="col-xs-12">
            <div class="transp-box">
                <br>
                <form class="form-horizontal" method="post" role="form">
                    <div class="form-group">
                        <label for="inputCurrentPassword" class="col-sm-2 control-label">Password</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" maxlength="20" id="inputCurrentPassword" placeholder="Password" name="current_password">
                            {% if error_current_password %}
                                <span class="error_message">Incorrect Password.</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inputEmail" class="col-sm-2 control-label">New email address</label>
                        <div class="col-sm-10">
                            <input type="email" class="form-control" pattern="[\S]+@[\S]+\.[\S]+" id="inputEmail" placeholder="New email address" name="email" value="{{email}}">
                            {% if error_email %}
                                <span class="error_message">Invalid email address.</span>
                            {% endif %}
                            {% if error_user_exists %}
                                <span class="error_message">This email address is already associated with an existing account.</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inputVerifyEmail" class="col-sm-2 control-label">Repeat email address</label>
                        <div class="col-sm-10">
                            <input type="email" class="form-control" id="inputVerifyEmail" placeholder="Repeat email address" name="verify_email">
                            {% if error_verify_email %}
                                <span class="error_message">The two emails do not match.</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <input type="hidden" name="state" value="{{state}}">
                            <button type="submit" class="btn btn-default">Change email</button><br>
                            {% if success_message %}
                                <span class="message">Email address has been changed. A confirmation email has been sent to {{user.email}}.</span>
                            {% endif %}
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <br>


{% endblock content %}
